CXmodel=function(t){this.targetElem=t,this.data={type:"",message:"",href:"",title:"",description:""},this.settings={}},CXmodel.prototype={constructor:CXmodel,init:function(){if(console.log(this.targetElem),this.settings=Object.assign(this.settings,CXcontrol.settings,CXcontrol.options),this.targetElem){var t=this.targetElem.dataset,e={};t.cxmodalBackground&&(e.background=t.cxmodalBackground),t.cxmodalDraggable&&(e.draggable=t.cxmodalDraggable),this.settings=Object.assign(this.settings,e),console.log(t),this.getData()}},getData:function(){var t=this.targetElem.dataset;this.data.href=this.targetElem.getAttribute("href"),this.data.href||(this.data.href=this.targetElem.getAttribute("src")),""<t.cxmodal&&(this.data.href=t.cxmodal),void 0!==t.cxmodalConfirm&&(this.data.message=t.cxmodalConfirm?t.cxmodalConfirm:this.data.href,this.data.type="confirm"),void 0!==t.cxmodalAlert&&(this.data.message=t.cxmodalAlert?t.cxmodalAlert:this.data.href,this.data.type="alert"),void 0!==t.cxmodalIframe&&(this.data.href=t.cxmodalIframe?t.cxmodalIframe:this.data.href,this.data.type="iframe"),void 0!==t.cxmodalTitle&&(this.data.title=t.cxmodalTitle?t.cxmodalTitle:this.targetElem.getAttribute("title"),!this.data.title&&this.targetElem.querySelector("[title]")&&(this.data.title=this.targetElem.querySelector("[title]").getAttribute("title"))),void 0!==t.cxmodalDescription&&(this.data.description=t.cxmodalDescription?t.cxmodalDescription:this.targetElem.getAttribute("alt"),!this.data.description&&this.targetElem.querySelector("[alt]")&&(this.data.description=this.targetElem.querySelector("[alt]").getAttribute("alt"))),this.getType()},getType:function(){this.data.type="alert";var t=this.data.href.split(".").pop();t=t.split("?")[0].toLowerCase();var e=["jpg","jpeg","gif","png"];e.includes(t)&&(this.data.type="image"),(e=["php","htm","html","txt"]).includes(t)&&(this.data.type="ajax"),console.log(this.data)}},CXview={TEMPLATE:'        <div class="cxmodal__window">            <div class="cxmodal__header"></div>            <span class="cxmodal__close">&times;</span>            <div class="cxmodal__body"></div>        </div>',elem:null,modal:null,bgrElem:null,offsetX:0,offsetY:0,init:function(t){CXview.bgrElem&&document.body.removeChild(CXview.bgrElem);var e=document.createElement("div");e.innerHTML=CXview.TEMPLATE,e.className="cxmodal",t&&(e.classList.add("cxmodal_background-"+t.background),"close"==t.background&&e.addEventListener("click",function(){CXview.close()}),t.draggable&&(e.classList.add("cxmodal_draggable"),e.querySelector(".cxmodal__header").addEventListener("mousedown",function(t){CXview.dragStart(t),document.onmousemove=function(t){CXview.drag(t)},document.onmouseup=function(t){CXview.dragStop(),t.stopPropagation()}})));e.querySelector(".cxmodal__window").addEventListener("click",function(t){t.stopPropagation()}),e.querySelector(".cxmodal__close").addEventListener("click",function(){CXview.close()}),document.body.appendChild(e),CXview.bgrElem=e,CXview.elem=e.querySelector(".cxmodal__window")},open:function(t,e,a){if(CXview.modal=a,CXview.init(e),CXview.elem.classList.add("cxmodal_"+t.type),document.querySelector(".cxmodal__header").innerHTML=t.header,document.querySelector(".cxmodal__body").innerHTML=t.body,t.footer){var o=document.createElement("div");o.className="cxmodal__footer",o.innerHTML=t.footer,CXview.elem.appendChild(o)}CXview.bgrElem.style.display="flex",console.log(CXview.elem)},close:function(){CXview.bgrElem.style.display="none",CXview.modal&&CXcontrol.open(CXview.modal)},dragStart:function(t){CXview.elem.style.opacity=.95,CXview.offsetX=t.offsetX,CXview.offsetY=t.offsetY,CXview.elem.style.margin=0,document.cursor="move",CXview.drag(t)},drag:function(t){CXview.elem.style.left=t.clientX-CXview.offsetX+"px",CXview.elem.style.top=t.clientY-CXview.offsetY+"px"},dragStop:function(){CXview.elem.style.opacity=1,CXview.elem.style.cursor="default",document.onmousemove=null,document.onmouseup=null}},CXcontrol={settings:{background:"close",draggable:!0},options:{},init:function(){var t,e=document.querySelectorAll("[data-cxmodal-alert], [data-cxmodal-confirm], [data-cxmodal]");for(t=0;t<e.length;t++){var a=new CXmodel(e[t]);a&&(e[t].modal=a,e[t].addEventListener("click",CXcontrol.open,!1))}window.alert=function(t){CXcontrol.open(t)}},ajax:function(t){var e;if(!XMLHttpRequest)return alert("Tyvärr inget stöd för AJAX, så data kan inte läsas in"),!1;(e=new XMLHttpRequest).open("GET",t,!0),e.send(null),e.onreadystatechange=function(){4===e.readyState&&200==e.status&&(document.querySelector(".cxmodal__body").innerHTML=e.response)}},open:function(t){var e,a={},o={};"string"==typeof t?(o=CXcontrol.settings,CXview.init(CXcontrol.settings),a.header="ALERT",a.body=t,a.footer='<button onclick="CXview.close()" type="button">OK</button>',CXview.open(a,o)):t instanceof Event?((e=t.currentTarget.modal).init(),t.preventDefault(),e.data.message?(e.data.type="alert",a=CXcontrol.getContent(e),o=e.settings,e.data.href!==e.data.message?CXview.open(a,o,e):CXview.open(a,o)):(a=CXcontrol.getContent(e),o=e.settings,CXview.open(a,o))):((e=t).init(),a=CXcontrol.getContent(e),o=e.settings,CXview.open(a,o))},getContent:function(t){var e={};return e.type=t.data.type,"image"==t.data.type&&(e.header=t.data.title,e.body='<img src="'+t.data.href+'" alt="'+t.data.description+'">',e.footer=t.data.description),"ajax"==t.data.type&&(e.body=CXcontrol.ajax(t.data.href),e.header=t.data.title?t.data.title:"AJAX"),"alert"==t.data.type&&(e.header=t.data.title?t.data.title:"ALERT",e.body="<p>"+t.data.message+"</p>",e.footer='<button onclick="CXview.close()" type="button">OK</button>'),e}},window.addEventListener("load",CXcontrol.init);
//# sourceMappingURL=cxmodal.min.js.map