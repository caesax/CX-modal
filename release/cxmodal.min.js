CXmodel=function(e){this.targetElem=e||null,this.data={type:"",href:"",title:"",description:"",message:"",messageType:"",messageTitle:""},this.settings={}},CXmodel.prototype={constructor:CXmodel,init:function(){if(this.targetElem){var e=this.targetElem.dataset;this.settings=Object.create(CXcontrol.defaults),e.cxmodalBackground&&(this.settings.background=e.cxmodalBackground),e.cxmodalDraggable&&(this.settings.draggable=e.cxmodalDraggable),console.log(this.settings),console.log(e),this.getData()}},getData:function(){var e=this.targetElem.dataset;this.data.href=this.targetElem.getAttribute("href"),this.data.href||(this.data.href=this.targetElem.getAttribute("src")),""<e.cxmodal&&(this.data.href=e.cxmodal),void 0!==e.cxmodalAjax?(this.data.href=e.cxmodalAjax?e.cxmodalAjax:this.data.href,this.data.type="ajax"):void 0!==e.cxmodalIframe?(this.data.href=e.cxmodalIframe?e.cxmodalIframe:this.data.href,this.data.type="iframe"):void 0!==e.cxmodalImage&&(this.data.href=e.cxmodalImage?e.cxmodalImage:this.data.href,this.data.type="image"),void 0!==e.cxmodalConfirm?(this.data.message=e.cxmodalConfirm?e.cxmodalConfirm:this.data.href,this.data.messageType="confirm",e.cxmodalConfirmTitle&&(this.data.messageTitle=e.cxmodalConfirmTitle)):void 0!==e.cxmodalAlert&&(this.data.message=e.cxmodalAlert?e.cxmodalAlert:this.data.href,this.data.messageType="alert",e.cxmodalAlertTitle&&(this.data.messageTitle=e.cxmodalMessageTitle)),void 0!==e.cxmodalTitle&&(this.data.title=e.cxmodalTitle?e.cxmodalTitle:this.targetElem.getAttribute("title"),!this.data.title&&this.targetElem.querySelector("[title]")&&(this.data.title=this.targetElem.querySelector("[title]").getAttribute("title"))),void 0!==e.cxmodalDescription&&(this.data.description=e.cxmodalDescription?e.cxmodalDescription:this.targetElem.getAttribute("alt"),!this.data.description&&this.targetElem.querySelector("[alt]")&&(this.data.description=this.targetElem.querySelector("[alt]").getAttribute("alt"))),this.data.type||this.guessType()},guessType:function(){var e=this.data.href.split(".").pop().split("?")[0].toLowerCase(),t="message";["jpg","jpeg","gif","png"].includes(e)?t="image":["php","htm","html","txt"].includes(e)?t="ajax":"http"==this.data.href.substr(0,4)&&(t="link"),this.data.type=t}},CXview={TEMPLATE:'        <div class="cxmodal__window">            <div class="cxmodal__header"></div>            <span class="cxmodal__close">&times;</span>            <div class="cxmodal__body"></div>        </div>',elem:null,modal:null,bgrElem:null,offsetX:0,offsetY:0,init:function(e){CXview.bgrElem&&document.body.removeChild(CXview.bgrElem);var t=document.createElement("div");t.innerHTML=CXview.TEMPLATE,t.className="cxmodal",e&&(t.classList.add("cxmodal--background-"+e.background),"close"==e.background&&t.addEventListener("click",function(){CXview.close()}),e.draggable&&(t.classList.add("cxmodal--draggable"),t.querySelector(".cxmodal__header").addEventListener("mousedown",function(e){CXview.dragStart(e),document.onmousemove=function(e){CXview.drag(e)},document.onmouseup=function(e){CXview.dragStop(),e.stopPropagation()}})));t.querySelector(".cxmodal__window").addEventListener("click",function(e){e.stopPropagation()}),t.querySelector(".cxmodal__close").addEventListener("click",function(){CXview.close()}),document.body.appendChild(t),CXview.bgrElem=t,CXview.elem=t.querySelector(".cxmodal__window")},open:function(e,t,a){if(CXview.modal=a,CXview.init(t),CXview.elem.classList.add("cxmodal--"+e.type),document.querySelector(".cxmodal__header").innerHTML=e.header,document.querySelector(".cxmodal__body").innerHTML=e.body,e.footer){var o=document.createElement("div");o.className="cxmodal__footer",o.innerHTML=e.footer,CXview.elem.appendChild(o)}CXview.bgrElem.style.display="flex",console.log(CXview.elem)},close:function(e){CXview.bgrElem.style.display="none",console.log(e),e&&CXview.modal&&CXcontrol.open(CXview.modal)},dragStart:function(e){CXview.elem.style.opacity=.95,CXview.offsetX=e.offsetX,CXview.offsetY=e.offsetY,CXview.elem.style.margin=0,document.cursor="move",CXview.drag(e)},drag:function(e){CXview.elem.style.left=e.clientX-CXview.offsetX+"px",CXview.elem.style.top=e.clientY-CXview.offsetY+"px"},dragStop:function(){CXview.elem.style.opacity=1,CXview.elem.style.cursor="default",document.onmousemove=null,document.onmouseup=null}},CXcontrol={defaults:{background:"close",draggable:!0,alertOverride:!0,confirmOverride:!0},options:{},init:function(){var e,t=document.querySelectorAll("[data-cxmodal-alert], [data-cxmodal-confirm], [data-cxmodal-iframe], [data-cxmodal-ajax], [data-cxmodal]");for(e=0;e<t.length;e++){var a=new CXmodel(t[e]);a&&(t[e].modal=a,t[e].addEventListener("click",CXcontrol.open,!1))}CXcontrol.options&&(CXcontrol.defaults=Object.assign(CXcontrol.defaults,CXcontrol.options)),CXcontrol.defaults.alertOverride&&(window.alert=function(e){CXcontrol.open(e,"alert")}),CXcontrol.defaults.confirmOverride&&(window.confirm=function(e){CXcontrol.open(e,"confirm")})},ajax:function(e){var t;if(!XMLHttpRequest)return alert("Tyvärr inget stöd för AJAX, så data kan inte läsas in"),!1;(t=new XMLHttpRequest).open("GET",e,!0),t.send(null),t.onreadystatechange=function(){4===t.readyState&&200==t.status&&(document.querySelector(".cxmodal__body").innerHTML=t.response)}},open:function(e,t){var a,o={},i={};t?(i=CXcontrol.defaults,CXview.init(i),o.header=t.toUpperCase(),o.body=e,o.footer='<button onclick="CXview.close(true)" type="button">OK</button>',"confirm"==t&&(o.footer='<button onclick="CXview.close(false)" type="button">Cancel</button> '+o.footer),CXview.open(o,i)):e instanceof Event?((a=e.currentTarget.modal).init(),e.preventDefault(),o=CXcontrol.getContent(a),i=a.settings,console.log(a.data),a.data.message&&a.data.message!==a.data.href?CXview.open(o,i,a):CXview.open(o,i)):"link"==(a=e).data.type?location.href=a.data.href:(a.data.messageType="",o=CXcontrol.getContent(a),i=a.settings,CXview.open(o,i))},getContent:function(e){var t={};return t.type=e.data.type,"image"==e.data.type?(t.header=e.data.title,t.body='<img class="cxmodal__body-img" src="'+e.data.href+'" alt="'+e.data.description+'">',t.footer=e.data.description):"ajax"==e.data.type?(t.body=CXcontrol.ajax(e.data.href),t.header=e.data.title?e.data.title:"AJAX"):"iframe"==e.data.type&&(t.body='<iframe src="'+e.data.href+'"></iframe>',t.header=e.data.title?e.data.title:"IFRAME",t.footer=e.data.description),"alert"==e.data.messageType?(t.type="alert",t.header=e.data.messageTitle?e.data.messageTitle:"ALERT",t.body="<p>"+e.data.message+"</p>",t.footer='<button class="cxmodal__footer-button" onclick="CXview.close(true)" type="button">OK</button>'):"confirm"==e.data.messageType&&(t.type="confirm",t.header=e.data.messageTitle?e.data.messageTitle:"CONFIRM",t.body="<p>"+e.data.message+"</p>",t.footer='<button class="cxmodal__footer-button" onclick="CXview.close(false)" type="button">Cancel</button><button class="cxmodal__footer-button" onclick="CXview.close(true)" type="button">OK</button>'),t}},window.addEventListener("load",CXcontrol.init);
//# sourceMappingURL=cxmodal.min.js.map